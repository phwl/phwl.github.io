I"æ<p>Here are installation instructions for installing Docker and running Modelsim for my <a href="https://cusp.sydney.edu.au/students/view-unit-page/alpha/ELEC3608">ELEC3608 Computer Architecture course</a>.</p>

<!-- more -->

<h1 id="1-installation">1. Installation</h1>
<h2 id="11-windows">1.1 Windows</h2>

<h3 id="install-xcxsrv">Install XcXsrv</h3>
<ul>
  <li>Install the VcXsrv X windows server <a href="https://sourceforge.net/projects/vcxsrv/">https://sourceforge.net/projects/vcxsrv/</a></li>
  <li>Run XLaunch and configure ‚ÄúMultiple Windows‚Äù and ‚ÄúStart no client‚Äù</li>
  <li>You will get an alert from Windows Defender. Allow access for Private Networks.</li>
</ul>

<h3 id="install-docker">Install Docker</h3>
<ul>
  <li>(Windows 10 Professional, Consumer and Education) Use instructions at <a href="https://docs.docker.com/docker-for-windows/install/">https://docs.docker.com/docker-for-windows/install/</a>
to install Stable version of Docker Desktop for Windows (follow them carefully). In the Configuration menu ensure that ‚ÄúEnable WEL 2 Windows Features‚Äù and ‚ÄúAdd shortcut to desktop‚Äù are selected.</li>
  <li>(Windows Home) I have not tested this but it should be the same as for Windows 10 except for the Install Docker step where you follow these instructions <a href="https://docs.docker.com/docker-for-windows/install-windows-home/">https://docs.docker.com/docker-for-windows/install-windows-home/</a></li>
  <li>Run Docker Desktop by double-clicking the icon on the desktop</li>
</ul>

<h2 id="12-macos">1.2 MacOS</h2>
<h3 id="install-docker-1">Install Docker</h3>
<ul>
  <li>Download and install stable version from <a href="https://docs.docker.com/docker-for-mac/install/">https://docs.docker.com/docker-for-mac/install/</a></li>
</ul>

<h1 id="2-testing">2 Testing</h1>
<h2 id="21-hello-world">2.1 Hello world</h2>
<p>To test basic Docker functionality, type <code class="language-plaintext highlighter-rouge">docker run hello-world</code> in the command window. Your output should be something like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre></div></div>

<h2 id="22-xeyes">2.2 Xeyes</h2>
<p>We need to use the X Server to display graphical output. This
tests X Windows basic functionality.</p>

<h3 id="211-windows">2.1.1 Windows</h3>
<ul>
  <li>Open a Windows Powershell window</li>
  <li>Type <code class="language-plaintext highlighter-rouge">ipconfig</code>. Note the IPv4 Address for the Ethernet Adapter vEthernet (WSL). On my machine it was 172.18.240.1</li>
  <li>Type <code class="language-plaintext highlighter-rouge">set-variable -name DISPLAY -value 172.18.240.1:0.0</code></li>
</ul>

<figure class="">
  <a href="/assets/images/2020/08/ipconfig-screenshot.png">
  <img src="/assets/images/2020/08/ipconfig-screenshot.png" alt="" />
  
    <figcaption>
      

    </figcaption></a></figure>

<ul>
  <li>Type <code class="language-plaintext highlighter-rouge">docker run -it -e DISPLAY=$DISPLAY fr3nd/xeyes</code></li>
</ul>

<h3 id="212-macos">2.1.2 MacOS</h3>
<ul>
  <li>Open a terminal</li>
  <li>Type <code class="language-plaintext highlighter-rouge">export DISPLAY=`hostname`:0.0</code></li>
  <li>Type <code class="language-plaintext highlighter-rouge">docker run -it -e DISPLAY=$DISPLAY fr3nd/xeyes</code></li>
</ul>

<p>You should see the window below and the eyes should move with your mouse.</p>

<figure class="">
  <a href="/assets/images/2020/08/xeyes-screenshot.png">
  <img src="/assets/images/2020/08/xeyes-screenshot.png" alt="" />
  
    <figcaption>
      

    </figcaption></a></figure>

<h2 id="23-modelsim">2.3 Modelsim</h2>
<p>Finally, this tests the Docker image for Modelsim (the executable is called
<code class="language-plaintext highlighter-rouge">vsim</code>).</p>

<ul>
  <li>(Windows) If your home directory is C:\Users\XX, you should now be able to run vsim <code class="language-plaintext highlighter-rouge">docker run -it -e DISPLAY=$DISPLAY -v C:\Users\XX:/mnt phwl/elec3608-vsim:latest vsim</code>.</li>
  <li>(MacOS) You should now be able to run vsim <code class="language-plaintext highlighter-rouge">docker run -it -e DISPLAY=$DISPLAY -v $HOME:/mnt phwl/elec3608-vsim:latest vsim</code>.</li>
</ul>

<p>If everything works, the Modelsim window should appear.</p>

<figure class="">
  <a href="/assets/images/2020/08/vsim-screenshot.png">
  <img src="/assets/images/2020/08/vsim-screenshot.png" alt="" />
  
    <figcaption>
      

    </figcaption></a></figure>

<h1 id="3-docker-image">3 Docker image</h1>
<p>The Docker image is based on one kindly provided by <a href="https://nachiket.github.io/">Prof Nachiket Kapre (Waterloo)</a>. The scripts used to create it are available <a href="https://github.com/phwl/elec3608-github">here</a>.</p>

<h1 id="4-troubleshooting">4 Troubleshooting</h1>
<ol>
  <li>Update your operating system to the latest version. My Windows 10 Pro installation was on Version 2004 (OS Build 19041.388).</li>
  <li>Check you have virtualization enabled in your BIOS
    <ul>
      <li>Reboot the computer and open the system‚Äôs BIOS menu. This can usually be done by pressing the delete key, the F1 key or Alt and F4 keys depending on the system.</li>
      <li>Enabling the virtualization extensions in BIOS.  Open the Processor submenu The processor settings menu may be hidden in the Chipset, Advanced CPU Configuration or Northbridge.  Enable Intel Virtualization Technology (also known as Intel VT-x). AMD-V extensions cannot be disabled in the BIOS and should already be enabled. The virtualization extensions may be labeled Virtualization Extensions, Vanderpool or various other names depending on the OEM and system BIOS.  Enable Intel VT-d or AMD IOMMU, if the options are available. Intel VT-d and AMD IOMMU are used for PCI device assignment.</li>
      <li>Select Save &amp; Exit.</li>
    </ul>
  </li>
  <li>If you are using Windows Home, you might like to update to the (more powerful) Windows 10 Education, Version 1809, available <a href="https://portal.azure.com/?Microsoft_Azure_Education_correlationId=0c971698-d014-4594-929c-2671f00288c3#blade/Microsoft_Azure_Education/EducationMenuBlade/software">here</a>. After installing, update to the latest version.</li>
</ol>

:ET