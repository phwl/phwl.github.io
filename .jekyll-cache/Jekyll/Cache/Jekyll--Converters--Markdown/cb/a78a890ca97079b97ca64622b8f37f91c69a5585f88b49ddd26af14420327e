I":<p>This post details how to use the GPIO peripheral on the ARM linux image 
built in <a href="/2021/emulated-ARM-Linux-with-Buildroot-and-QEMU/">Creating an emulated ARM Linux system using Buildroot and QEMU</a></p>

<h2 id="step-1-using-gpio">Step 1 Using GPIO</h2>
<p>Note that the <a href="https://git.kernel.org/pub/scm/libs/libgpiod/libgpiod.git/about/">Linux GPIO interface</a> was updated in 2020. Here is a link
to a website explaining the changes
<a href="https://microhobby.com.br/blog/2020/02/02/new-linux-kernel-5-5-new-interfaces-in-gpiolib/">https://microhobby.com.br/blog/2020/02/02/new-linux-kernel-5-5-new-interfaces-in-gpiolib/</a>. Many tutorials on the web are either obsolete or 
wonâ€™t work with current Linux kernels.</p>

<p>The peripheral used in the
qemu_aarch64_virt machine is described in the 
 <a href="https://developer.arm.com/documentation/ddi0190/b">ARM PrimeCell General Purpose Input/Output (PL061) Technical Reference Manual</a> GPIO device. There are
two ways to find out its start address in memory. During boot up, the message</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pl061_gpio 9030000.pl061: PL061 GPIO chip registered
</code></pre></div></div>
<p>or using
<code class="language-plaintext highlighter-rouge">info mtree</code> in the QEMU monitor, you get</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0000000009030000-0000000009030fff (prio 0, i/o): pl061
</code></pre></div></div>
<p>Thus the start address is 0x9030000.</p>
:ET