I"ò<h1 id="installation-of-software-for-ettus-b210">Installation of software for Ettus B210.</h1>

<h2 id="part-1-2-april-2020">Part 1 2 April, 2020</h2>

<!-- more -->

<ol>
  <li>Follow instructions at <a href="https://kb.ettus.com/Building_and_Installing_the_USRP_Open-Source_Toolchain_(UHD_and_GNU_Radio)_on_Linux">https://kb.ettus.com/Building_and_Installing_the_USRP_Open-Source_Toolchain_(UHD_and_GNU_Radio)_on_Linux</a>.
    <ul>
      <li>For UHD
        <ul>
          <li>git checkout v3.15.0.0-rc3</li>
        </ul>
      </li>
      <li>For GNU radio
        <ul>
          <li><span style="color:red"> Donâ€™t do the below as it is more complicated and you donâ€™t get the Instrumentation blocks in gnuradio-companion</span>
            <ul>
              <li>git checkout v3.8.1.0-rc1</li>
              <li>
                <p>Since Ubuntu puts liblog4cpp in <code class="highlighter-rouge">/usr/lib/x86_64-linux-gnu</code>, I had to modify <code class="highlighter-rouge">gnuradio/cmake/Modules/FindLOG4CPP.cmake:</code> (before running <code class="highlighter-rouge">cmake ../</code>):</p>

                <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PATHS /usr/lib /usr/lib64 /usr/local/lib  /usr/local/lib64 /opt/local/lib /opt/local/lib64 /usr/lib/x86_64-linux-gnu
</code></pre></div>                </div>
              </li>
              <li><code class="highlighter-rouge">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib:/usr/lib/x86_64-linux-gnu</code></li>
              <li><code class="highlighter-rouge">export PYTHONPATH=$PYTHONPATH:/usr/local/lib/python3/dist-packages</code></li>
            </ul>
          </li>
          <li>Do this <a href="https://launchpad.net/~gnuradio/+archive/ubuntu/gnuradio-releases">https://launchpad.net/~gnuradio/+archive/ubuntu/gnuradio-releases</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Install Pothosware using instructions from <a href="https://github.com/pothosware/PothosCore/wiki/Ubuntu">https://github.com/pothosware/PothosCore/wiki/Ubuntu</a>
    <ul>
      <li><code class="highlighter-rouge">export UHD_IMAGES_DIR=/usr/local/share/uhd/images</code></li>
    </ul>
  </li>
  <li>Then I got the error <code class="highlighter-rouge">RuntimeError: Expected FPGA compatibility number 14, but got 16</code>
    <ul>
      <li>So I installed UHD v3.12.0.0 instead as it is the latest version with compatibility number 14, cycled the Ettus radio and rebooted the Ubuntu machine</li>
      <li>That finally worked and I could include a UHD source block in gnuradio-companion</li>
    </ul>
  </li>
</ol>

<h2 id="part-2-3-april-2020">Part 2 3 April, 2020</h2>
<p>All was well but I couldnâ€™t make gr-specest work so letâ€™s try using PyBombs.</p>

<ol>
  <li>Remove UHD and GNU radio
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd ~/src/ettus/uhd/host/build/
sudo make uninstall
sudo apt-get uninstall gnuradio
</code></pre></div>    </div>
  </li>
  <li>Install PyBombs
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 install --upgrade git+https://github.com/gnuradio/pybombs.git
pybombs auto-config
pybombs recipes add-defaults
pybombs prefix init ~/gnuradio
source ~/gnuradio/setup_env.sh
# Edit ~/.pybombs/recipes/gr-recipes/gnuradio.lwr and add "-DENABLE_CTRLPORT_THRIFT=OFF" in "config_opt"
pybombs install uhd
sudo apt install git cmake g++ libboost-all-dev libgmp-dev \
   swig python3-numpy python3-mako python3-sphinx python3-lxml \
   doxygen libfftw3-dev libcomedi-dev libsdl1.2-dev libgsl-dev \
   libqwt-qt5-dev libqt5opengl5-dev python3-pyqt5 liblog4cpp5-dev \
   libzmq3-dev python3-yaml python3-click python3-click-plugins
pybombs install gnuradio
</code></pre></div>    </div>
  </li>
</ol>
:ET